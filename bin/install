#!/bin/sh

declare inOptions
declare outOptions

inOptions=("$@")

if [ `whoami` = "fibo" -o "$ROOTLESS_GOBOLINUX" = 1 ]
then
   skipnext=0
   o=0
   for (( i = 0; i < "${#inOptions[@]}"; i++ ))
   do
      if [ "$skipnext" = 1 ]
      then
         skipnext=0
      elif [ "${inOptions[i]}" = "-o" -o "${inOptions[i]}" = "-g" ]
      then
         skipnext=1
      elif [ "${inOptions[i]:0:2}" = "-o" -o "${inOptions[i]:0:2}" = "-g" ]
      then
         : # skip this
      elif [ "${inOptions[i]:0:1}" = "-" -a "$goboCrossCompiling" ]
      then
         # ignore strip options if cross-compiling
         outOptions[o]=`echo "${inOptions[i]}" | sed 's,s,,g' | sed 's,--strip,,g'`
         o=$[o+1]
      else
         outOptions[o]="${inOptions[i]}"
         o=$[o+1]
      fi
   done
else
   for (( i = 0; i < "${#inOptions[@]}"; i++ ))
   do
      if [ "${inOptions[i]}" = "root" ]
      then
         outOptions[i]="0"
      elif [ "${inOptions[i]:0:1}" = "-" -a "$goboCrossCompiling" ]
      then
         # ignore strip options if cross-compiling
         outOptions[i]=`echo "${inOptions[i]}" | sed 's,s,,g' | sed 's,--strip,,g'`
      else
         outOptions[i]="${inOptions[i]}"
      fi
   done
fi

real_install "${outOptions[@]}"
