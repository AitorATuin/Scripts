#!/bin/sh

source ScriptFunctions
Import File
Import GoboLinux
Import Log
Import OptionParser
Import Process
Import String

### Changelog #################################################################
#
# 09/11/2005 - [calica] Move GPG_gobo_keyring to Functions/File
#                       Run as normal user
#                       Change description
# 10/10/2004 - [calica] Use Data/gpg/goboring.pub instead.
# 2003/12/15 - [calica] First version

### Options ###################################################################

scriptDescription="Manage official GoboLinux keyring. For use by GoboLinux devs ONLY!!!"
scriptCredits="Copyright (C) 2003 Carlo Calica. Released under the GNU GPL."
helpOnNoArguments=yes
scriptUsage="{ <key_file> }"
scriptNotes="This is meant to be run when Current is linked to CVS tracking work dir.
It will change $GPG_gobo_keyring which should be commited to CVS."
Add_Option_Boolean "i" "import" "Import key"
Add_Option_Boolean "l" "list" "List public keys"
Parse_Options "$@"
shift $parsedArguments

### Utility functions #################################################################
GPG_opts="--keyring ${GPG_gobo_keyring} --no-default-keyring"


### Parse options #######################################################################

### --import: import key################################################

if Boolean "import"
then
#   Verify_Superuser
   mkdir -p `dirname $GPG_gobo_keyring`
   gpg ${GPG_opts} --import "$@"
   chmod 644 $GPG_gobo_keyring
   exit 0
fi

### --list: list public keys ########################################################

if Boolean "list"
then
   gpg ${GPG_opts} --list-keys
   exit 0
fi

